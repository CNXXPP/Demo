<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.great.dao.StuCardTimeMapper">
  <resultMap id="BaseResultMap" type="com.great.entity.StuCardTime">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 26 17:46:16 CST 2017.
    -->
    <id column="CT_UUID" jdbcType="VARCHAR" property="ctUuid" />
    <result column="STU_UUID" jdbcType="VARCHAR" property="stuUuid" />
    <result column="CT_SUB1" jdbcType="DECIMAL" property="ctSub1" />
    <result column="CT_SUB2" jdbcType="DECIMAL" property="ctSub2" />
    <result column="CT_SUB3" jdbcType="DECIMAL" property="ctSub3" />
    <result column="CT_SUB4" jdbcType="DECIMAL" property="ctSub4" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 26 17:46:16 CST 2017.
    -->
    CT_UUID, STU_UUID, CT_SUB1, CT_SUB2, CT_SUB3, CT_SUB4
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 26 17:46:16 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from STU_CARD_TIME
    where CT_UUID = #{ctUuid,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 26 17:46:16 CST 2017.
    -->
    delete from STU_CARD_TIME
    where CT_UUID = #{ctUuid,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.great.entity.StuCardTime">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 26 17:46:16 CST 2017.
    -->
    insert into STU_CARD_TIME (CT_UUID, STU_UUID, CT_SUB1, 
      CT_SUB2, CT_SUB3, CT_SUB4
      )
    values (#{ctUuid,jdbcType=VARCHAR}, #{stuUuid,jdbcType=VARCHAR}, #{ctSub1,jdbcType=DECIMAL}, 
      #{ctSub2,jdbcType=DECIMAL}, #{ctSub3,jdbcType=DECIMAL}, #{ctSub4,jdbcType=DECIMAL}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.great.entity.StuCardTime">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 26 17:46:16 CST 2017.
    -->
    insert into STU_CARD_TIME
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="ctUuid != null">
        CT_UUID,
      </if>
      <if test="stuUuid != null">
        STU_UUID,
      </if>
      <if test="ctSub1 != null">
        CT_SUB1,
      </if>
      <if test="ctSub2 != null">
        CT_SUB2,
      </if>
      <if test="ctSub3 != null">
        CT_SUB3,
      </if>
      <if test="ctSub4 != null">
        CT_SUB4,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="ctUuid != null">
        #{ctUuid,jdbcType=VARCHAR},
      </if>
      <if test="stuUuid != null">
        #{stuUuid,jdbcType=VARCHAR},
      </if>
      <if test="ctSub1 != null">
        #{ctSub1,jdbcType=DECIMAL},
      </if>
      <if test="ctSub2 != null">
        #{ctSub2,jdbcType=DECIMAL},
      </if>
      <if test="ctSub3 != null">
        #{ctSub3,jdbcType=DECIMAL},
      </if>
      <if test="ctSub4 != null">
        #{ctSub4,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.great.entity.StuCardTime">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 26 17:46:16 CST 2017.
    -->
    update STU_CARD_TIME
    <set>
      <if test="stuUuid != null">
        STU_UUID = #{stuUuid,jdbcType=VARCHAR},
      </if>
      <if test="ctSub1 != null">
        CT_SUB1 = #{ctSub1,jdbcType=DECIMAL},
      </if>
      <if test="ctSub2 != null">
        CT_SUB2 = #{ctSub2,jdbcType=DECIMAL},
      </if>
      <if test="ctSub3 != null">
        CT_SUB3 = #{ctSub3,jdbcType=DECIMAL},
      </if>
      <if test="ctSub4 != null">
        CT_SUB4 = #{ctSub4,jdbcType=DECIMAL},
      </if>
    </set>
    where CT_UUID = #{ctUuid,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.great.entity.StuCardTime">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 26 17:46:16 CST 2017.
    -->
    update STU_CARD_TIME
    set STU_UUID = #{stuUuid,jdbcType=VARCHAR},
      CT_SUB1 = #{ctSub1,jdbcType=DECIMAL},
      CT_SUB2 = #{ctSub2,jdbcType=DECIMAL},
      CT_SUB3 = #{ctSub3,jdbcType=DECIMAL},
      CT_SUB4 = #{ctSub4,jdbcType=DECIMAL}
    where CT_UUID = #{ctUuid,jdbcType=VARCHAR}
  </update>
  <select id="selectBystuId" parameterType="java.lang.String" resultMap="BaseResultMap">
      SELECT * FROM STU_CARD_TIME WHERE STU_UUID=#{stuUuid}
  </select>
  
  <select id="showSignInShows" parameterType="com.great.entity.Student" resultMap="change">
   select d.sch_name,stu.stu_name,stu.stu_identity,sub.sub_name,sub.sub_need_time
   <if test="subNo==1"> ,cardtime.ct_sub1 stuTIME</if>
    <if test="subNo==2"> ,cardtime.ct_sub2 stuTIME</if>
     <if test="subNo==3">, cardtime.ct_sub3 stuTIME</if>
      <if test="subNo==4"> ,cardtime.ct_sub4 stuTIME</if>
   from  student stu left join subject sub on stu.sub_no=sub.sub_no 
   left join school_stu schs on stu.stu_uuid =schs.stu_uuid
   left join driver_school d on schs.sch_uuid=d.sch_uuid 
   left join stu_card_time cardtime on stu.stu_uuid=cardtime.stu_uuid where stu.stu_uuid=#{stuUuid}
  </select>
  
  <resultMap type="com.great.entity.SignInShow" id="change">
        <result column="sch_name" property="schoolName"/>
        <result column="stu_name" property="stuName"/>
        <result column="stu_identity" property="idCard"/>
        <result column="sub_name" property="subject"/>
        <result column="sub_need_time" property="totalHours"/>
        <result column="stuTIME" property="cumulativeHours"/>
   </resultMap>
   
    <resultMap type="com.great.entity.CheckStuCardTime" id="checkTime">
        <result column="stu_uuid" property="stuUuid"/>
        <result column="stu_id" property="stuId"/>
        <result column="stu_name" property="stuName"/>
        <result column="ct_sub1" property="ctSub1"/>
        <result column="ct_sub2" property="ctSub2"/>
        <result column="ct_sub3" property="ctSub3"/>
        <result column="ct_sub4" property="ctSub4"/>
   </resultMap>
   
   
   
      <!-- 查询学员学时 /江建楠-->
	<select id="getStuTime" parameterType="com.great.entity.DriverSchool" resultMap="checkTime">
		select stu_uuid,stu_id,stu_name,ct_sub1,ct_sub2,ct_sub3,ct_sub4
		from (school_stu left join student on school_stu.stu_uuid = student.stu_uuid)
		left join stu_card_time on school_stu.stu_uuid = stu_card_time.stu_uuid  
		where sch_uuid = #{schUuid,jdbcType=VARCHAR}
	</select>
	
	
	<update id="updateCartTime" parameterType="java.lang.String">
	    UPDATE STU_CARD_TIME SET CT_SUB1 = #{0} WHERE STU_UUID = #{1}
	</update>
	<update id="upCartTime" parameterType="java.lang.String">
	    UPDATE STU_CARD_TIME SET CT_SUB4 = #{0} WHERE STU_UUID = #{1}
	</update>
</mapper>